from pwn import *
import hashlib
import base64

f1 = open('shattered-1.pdf', 'rb').read()
f2 = open('shattered-2.pdf', 'rb').read()

encoder = hashlib.sha1()
encoder.update(f1)
print(encoder.digest())
encoder.update(f2)
print(encoder.digest())

conn = remote('140.116.215.203', 5001)
conn.recvline('Input first secret:')
conn.sendline(base64.b64encode(f1))
conn.recvline('Input second secret:')
conn.sendline(base64.b64encode(f2))
conn.interactive()
